2021-07-21 07:29:28.087556: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-07-21 07:29:28.087597: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: UNKNOWN ERROR (-1)
2021-07-21 07:29:28.087626: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:163] no NVIDIA GPU device is present: /dev/nvidia0 does not exist
2021-07-21 07:29:28.087929: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2021-07-21 07:29:28.138975: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2899885000 Hz
2021-07-21 07:29:28.142422: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f75fc000b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-07-21 07:29:28.142459: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-07-21 07:29:28,378 : swarm.mlCnt : INFO : Setting up ml layer for the swarm node: START
2021-07-21 07:29:28,387 : swarm.mlCnt : INFO : ML is running on a normal fullnode!
2021-07-21 07:29:38,554 : swarm.mlCnt : INFO : Failed to connect to the API Server. Retrying 2 of 12
2021-07-21 07:29:48,566 : swarm.mlCnt : INFO : Failed to connect to the API Server. Retrying 3 of 12
2021-07-21 07:29:58,576 : swarm.mlCnt : INFO : Failed to connect to the API Server. Retrying 4 of 12
2021-07-21 07:30:09,169 : swarm.mlCnt : INFO : Failed to connect to the API Server. Retrying 5 of 12
2021-07-21 07:30:19,178 : swarm.mlCnt : INFO : Failed to connect to the API Server. Retrying 6 of 12
2021-07-21 07:30:19,190 : swarm.mlCnt : INFO : Instantiating file services for ml node 172.26.0.4
SMLFS: Loading State File : /platform/swarmml/SMLNODE/smlfs_state_latest.json
localIp for fs service = 172.26.0.4
2021-07-21 07:30:19,205 : swarm.mlCnt : INFO : Successfully completed the initialization of ML container ...
2021-07-21 07:30:19,250 : swarm.mlCnt : INFO : ***Swarm Callback Params***
2021-07-21 07:30:19,250 : swarm.mlCnt : INFO : sync_interval: 128
2021-07-21 07:30:19,250 : swarm.mlCnt : INFO : min_peers: 2
2021-07-21 07:30:19,250 : swarm.mlCnt : INFO : max_peers: 0
2021-07-21 07:30:19,250 : swarm.mlCnt : INFO : val_batch_size: 32
2021-07-21 07:30:19,250 : swarm.mlCnt : INFO : ***************************
2021-07-21 07:30:19,250 : swarm.mlCnt : INFO : Creating object for context: defaultbb.cqdb.sml.hpe
2021-07-21 07:30:21,326 : swarm.smlCBB : INFO : ***Swarm Network Configuration***
2021-07-21 07:30:21,326 : swarm.smlCBB : INFO : Context:defaultbb.cqdb.sml.hpe
2021-07-21 07:30:21,326 : swarm.smlCBB : INFO :     syncInterval      : 128
2021-07-21 07:30:21,326 : swarm.smlCBB : INFO :     min_peers         : 2
2021-07-21 07:30:21,326 : swarm.smlCBB : INFO :     blackboard_set_by : 172.26.0.4
2021-07-21 07:30:21,326 : swarm.smlCBB : INFO :     adaptive_sync     : False
2021-07-21 07:30:21,326 : swarm.smlCBB : INFO : ***************************
2021-07-21 07:30:21.417091: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 188160000 exceeds 10% of free system memory.
2021-07-21 07:30:21,524 : swarm.mlCnt : INFO : Merging ...
Epoch 1/5
  1/469 [..............................] - ETA: 0s - loss: 2.3136 - accuracy: 0.1484 21/469 [>.............................] - ETA: 1s - loss: 1.2588 - accuracy: 0.6957 44/469 [=>............................] - ETA: 0s - loss: 0.8603 - accuracy: 0.7825 69/469 [===>..........................] - ETA: 0s - loss: 0.6897 - accuracy: 0.8211 92/469 [====>.........................] - ETA: 0s - loss: 0.6098 - accuracy: 0.8378117/469 [======>.......................] - ETA: 0s - loss: 0.5506 - accuracy: 0.85102021-07-21 07:32:01,429 : swarm.mlCnt : INFO : Merging ...
129/469 [=======>......................] - ETA: 28s - loss: 0.5274 - accuracy: 0.8564154/469 [========>.....................] - ETA: 21s - loss: 0.4875 - accuracy: 0.8663177/469 [==========>...................] - ETA: 17s - loss: 0.4599 - accuracy: 0.8735200/469 [===========>..................] - ETA: 14s - loss: 0.4349 - accuracy: 0.8798222/469 [=============>................] - ETA: 12s - loss: 0.4159 - accuracy: 0.8847249/469 [==============>...............] - ETA: 9s - loss: 0.3959 - accuracy: 0.8899 2021-07-21 07:32:12,060 : swarm.mlCnt : INFO : Merging ...
257/469 [===============>..............] - ETA: 17s - loss: 0.3908 - accuracy: 0.8913277/469 [================>.............] - ETA: 14s - loss: 0.3780 - accuracy: 0.8946299/469 [==================>...........] - ETA: 12s - loss: 0.3649 - accuracy: 0.8983325/469 [===================>..........] - ETA: 9s - loss: 0.3516 - accuracy: 0.9020 344/469 [=====================>........] - ETA: 7s - loss: 0.3431 - accuracy: 0.9045367/469 [======================>.......] - ETA: 5s - loss: 0.3348 - accuracy: 0.90692021-07-21 07:32:22,694 : swarm.mlCnt : INFO : Merging ...
385/469 [=======================>......] - ETA: 6s - loss: 0.3282 - accuracy: 0.9086408/469 [=========================>....] - ETA: 4s - loss: 0.3187 - accuracy: 0.9112436/469 [==========================>...] - ETA: 2s - loss: 0.3090 - accuracy: 0.9137465/469 [============================>.] - ETA: 0s - loss: 0.3009 - accuracy: 0.9162469/469 [==============================] - 32s 68ms/step - loss: 0.3002 - accuracy: 0.9163
Epoch 2/5
  1/469 [..............................] - ETA: 0s - loss: 0.1094 - accuracy: 0.9688 30/469 [>.............................] - ETA: 0s - loss: 0.1525 - accuracy: 0.95472021-07-21 07:32:33,322 : swarm.mlCnt : INFO : Merging ...
 44/469 [=>............................] - ETA: 1:41 - loss: 0.1541 - accuracy: 0.9533 67/469 [===>..........................] - ETA: 1:03 - loss: 0.1524 - accuracy: 0.9548 95/469 [=====>........................] - ETA: 41s - loss: 0.1488 - accuracy: 0.9567 118/469 [======>.......................] - ETA: 31s - loss: 0.1468 - accuracy: 0.9568136/469 [=======>......................] - ETA: 26s - loss: 0.1420 - accuracy: 0.9580149/469 [========>.....................] - ETA: 23s - loss: 0.1414 - accuracy: 0.9578163/469 [=========>....................] - ETA: 20s - loss: 0.1410 - accuracy: 0.95792021-07-21 07:32:44,044 : swarm.mlCnt : INFO : Merging ...
172/469 [==========>...................] - ETA: 36s - loss: 0.1420 - accuracy: 0.9575194/469 [===========>..................] - ETA: 30s - loss: 0.1415 - accuracy: 0.9579217/469 [============>.................] - ETA: 24s - loss: 0.1398 - accuracy: 0.9588228/469 [=============>................] - ETA: 22s - loss: 0.1393 - accuracy: 0.9587243/469 [==============>...............] - ETA: 19s - loss: 0.1389 - accuracy: 0.9590259/469 [===============>..............] - ETA: 17s - loss: 0.1377 - accuracy: 0.9593272/469 [================>.............] - ETA: 15s - loss: 0.1365 - accuracy: 0.9599287/469 [=================>............] - ETA: 13s - loss: 0.1350 - accuracy: 0.96032021-07-21 07:32:54,856 : swarm.mlCnt : INFO : Merging ...
300/469 [==================>...........] - ETA: 18s - loss: 0.1332 - accuracy: 0.9608315/469 [===================>..........] - ETA: 15s - loss: 0.1321 - accuracy: 0.9612330/469 [====================>.........] - ETA: 13s - loss: 0.1312 - accuracy: 0.9616342/469 [====================>.........] - ETA: 11s - loss: 0.1304 - accuracy: 0.9617355/469 [=====================>........] - ETA: 10s - loss: 0.1302 - accuracy: 0.9618369/469 [======================>.......] - ETA: 8s - loss: 0.1297 - accuracy: 0.9619 385/469 [=======================>......] - ETA: 7s - loss: 0.1291 - accuracy: 0.9623398/469 [========================>.....] - ETA: 5s - loss: 0.1286 - accuracy: 0.9625411/469 [=========================>....] - ETA: 4s - loss: 0.1271 - accuracy: 0.96292021-07-21 07:33:05,715 : swarm.mlCnt : INFO : Merging ...
428/469 [==========================>...] - ETA: 4s - loss: 0.1262 - accuracy: 0.9631448/469 [===========================>..] - ETA: 1s - loss: 0.1252 - accuracy: 0.9633469/469 [==============================] - 42s 90ms/step - loss: 0.1230 - accuracy: 0.9639
Epoch 3/5
  1/469 [..............................] - ETA: 0s - loss: 0.1151 - accuracy: 0.9766 23/469 [>.............................] - ETA: 0s - loss: 0.0939 - accuracy: 0.9698 47/469 [==>...........................] - ETA: 0s - loss: 0.0963 - accuracy: 0.9704 68/469 [===>..........................] - ETA: 0s - loss: 0.0949 - accuracy: 0.97102021-07-21 07:33:15,807 : swarm.mlCnt : INFO : Merging ...
 87/469 [====>.........................] - ETA: 46s - loss: 0.0927 - accuracy: 0.9717101/469 [=====>........................] - ETA: 38s - loss: 0.0933 - accuracy: 0.9716112/469 [======>.......................] - ETA: 33s - loss: 0.0910 - accuracy: 0.9724125/469 [======>.......................] - ETA: 29s - loss: 0.0901 - accuracy: 0.9728139/469 [=======>......................] - ETA: 25s - loss: 0.0883 - accuracy: 0.9732154/469 [========>.....................] - ETA: 22s - loss: 0.0912 - accuracy: 0.9726169/469 [=========>....................] - ETA: 19s - loss: 0.0908 - accuracy: 0.9725183/469 [==========>...................] - ETA: 17s - loss: 0.0901 - accuracy: 0.9726198/469 [===========>..................] - ETA: 15s - loss: 0.0907 - accuracy: 0.97252021-07-21 07:33:26,624 : swarm.mlCnt : INFO : Merging ...
215/469 [============>.................] - ETA: 25s - loss: 0.0897 - accuracy: 0.9729230/469 [=============>................] - ETA: 22s - loss: 0.0886 - accuracy: 0.9732245/469 [==============>...............] - ETA: 19s - loss: 0.0886 - accuracy: 0.9735261/469 [===============>..............] - ETA: 17s - loss: 0.0889 - accuracy: 0.9734275/469 [================>.............] - ETA: 15s - loss: 0.0886 - accuracy: 0.9734291/469 [=================>............] - ETA: 13s - loss: 0.0881 - accuracy: 0.9734304/469 [==================>...........] - ETA: 11s - loss: 0.0879 - accuracy: 0.9737317/469 [===================>..........] - ETA: 10s - loss: 0.0875 - accuracy: 0.9739331/469 [====================>.........] - ETA: 9s - loss: 0.0869 - accuracy: 0.9742 2021-07-21 07:33:37,368 : swarm.mlCnt : INFO : Merging ...
343/469 [====================>.........] - ETA: 11s - loss: 0.0870 - accuracy: 0.9742357/469 [=====================>........] - ETA: 10s - loss: 0.0870 - accuracy: 0.9743371/469 [======================>.......] - ETA: 8s - loss: 0.0861 - accuracy: 0.9745 384/469 [=======================>......] - ETA: 7s - loss: 0.0854 - accuracy: 0.9748397/469 [========================>.....] - ETA: 5s - loss: 0.0851 - accuracy: 0.9748412/469 [=========================>....] - ETA: 4s - loss: 0.0846 - accuracy: 0.9748428/469 [==========================>...] - ETA: 3s - loss: 0.0844 - accuracy: 0.9750450/469 [===========================>..] - ETA: 1s - loss: 0.0839 - accuracy: 0.9751469/469 [==============================] - 33s 70ms/step - loss: 0.0837 - accuracy: 0.9752
Epoch 4/5
  1/469 [..............................] - ETA: 0s - loss: 0.0705 - accuracy: 0.96882021-07-21 07:33:48,257 : swarm.mlCnt : INFO : Merging ...
  2/469 [..............................] - ETA: 40:03 - loss: 0.0766 - accuracy: 0.9727WARNING:tensorflow:Method (on_train_batch_end) is slow compared to the batch update (5.145354). Check your callbacks.
 15/469 [..............................] - ETA: 5:13 - loss: 0.0625 - accuracy: 0.9818  29/469 [>.............................] - ETA: 2:37 - loss: 0.0593 - accuracy: 0.9838 40/469 [=>............................] - ETA: 1:52 - loss: 0.0625 - accuracy: 0.9812 55/469 [==>...........................] - ETA: 1:19 - loss: 0.0621 - accuracy: 0.9817 69/469 [===>..........................] - ETA: 1:01 - loss: 0.0608 - accuracy: 0.9819 82/469 [====>.........................] - ETA: 50s - loss: 0.0619 - accuracy: 0.9812  97/469 [=====>........................] - ETA: 40s - loss: 0.0632 - accuracy: 0.9810111/469 [======>.......................] - ETA: 34s - loss: 0.0619 - accuracy: 0.9816127/469 [=======>......................] - ETA: 28s - loss: 0.0619 - accuracy: 0.98162021-07-21 07:33:59,024 : swarm.mlCnt : INFO : Merging ...
130/469 [=======>......................] - ETA: 55s - loss: 0.0622 - accuracy: 0.9816144/469 [========>.....................] - ETA: 47s - loss: 0.0624 - accuracy: 0.9817158/469 [=========>....................] - ETA: 41s - loss: 0.0639 - accuracy: 0.9812173/469 [==========>...................] - ETA: 36s - loss: 0.0627 - accuracy: 0.9816186/469 [==========>...................] - ETA: 32s - loss: 0.0630 - accuracy: 0.9814199/469 [===========>..................] - ETA: 29s - loss: 0.0628 - accuracy: 0.9818213/469 [============>.................] - ETA: 25s - loss: 0.0631 - accuracy: 0.9814229/469 [=============>................] - ETA: 22s - loss: 0.0625 - accuracy: 0.9816246/469 [==============>...............] - ETA: 19s - loss: 0.0620 - accuracy: 0.98162021-07-21 07:34:09,863 : swarm.mlCnt : INFO : Merging ...
258/469 [===============>..............] - ETA: 26s - loss: 0.0630 - accuracy: 0.9811272/469 [================>.............] - ETA: 23s - loss: 0.0628 - accuracy: 0.9812286/469 [=================>............] - ETA: 20s - loss: 0.0621 - accuracy: 0.9815299/469 [==================>...........] - ETA: 18s - loss: 0.0628 - accuracy: 0.9813310/469 [==================>...........] - ETA: 16s - loss: 0.0628 - accuracy: 0.9814323/469 [===================>..........] - ETA: 14s - loss: 0.0627 - accuracy: 0.9814335/469 [====================>.........] - ETA: 12s - loss: 0.0625 - accuracy: 0.9816348/469 [=====================>........] - ETA: 11s - loss: 0.0623 - accuracy: 0.9816362/469 [======================>.......] - ETA: 9s - loss: 0.0623 - accuracy: 0.9815 377/469 [=======================>......] - ETA: 7s - loss: 0.0626 - accuracy: 0.98142021-07-21 07:34:20,654 : swarm.mlCnt : INFO : Merging ...
386/469 [=======================>......] - ETA: 9s - loss: 0.0626 - accuracy: 0.9813408/469 [=========================>....] - ETA: 6s - loss: 0.0625 - accuracy: 0.9812434/469 [==========================>...] - ETA: 3s - loss: 0.0617 - accuracy: 0.9815459/469 [============================>.] - ETA: 0s - loss: 0.0614 - accuracy: 0.9816469/469 [==============================] - 42s 90ms/step - loss: 0.0615 - accuracy: 0.9816
Epoch 5/5
  1/469 [..............................] - ETA: 0s - loss: 0.0653 - accuracy: 0.9766 24/469 [>.............................] - ETA: 0s - loss: 0.0485 - accuracy: 0.98572021-07-21 07:34:30,692 : swarm.mlCnt : INFO : Merging ...
 45/469 [=>............................] - ETA: 1:48 - loss: 0.0509 - accuracy: 0.9844 71/469 [===>..........................] - ETA: 1:04 - loss: 0.0509 - accuracy: 0.9849 92/469 [====>.........................] - ETA: 47s - loss: 0.0494 - accuracy: 0.9851 109/469 [=====>........................] - ETA: 38s - loss: 0.0492 - accuracy: 0.9850136/469 [=======>......................] - ETA: 28s - loss: 0.0504 - accuracy: 0.9849160/469 [=========>....................] - ETA: 22s - loss: 0.0502 - accuracy: 0.98502021-07-21 07:34:42,351 : swarm.mlCnt : INFO : Merging ...
173/469 [==========>...................] - ETA: 36s - loss: 0.0506 - accuracy: 0.9846198/469 [===========>..................] - ETA: 29s - loss: 0.0497 - accuracy: 0.9849223/469 [=============>................] - ETA: 23s - loss: 0.0496 - accuracy: 0.9850238/469 [==============>...............] - ETA: 21s - loss: 0.0484 - accuracy: 0.9854249/469 [==============>...............] - ETA: 19s - loss: 0.0485 - accuracy: 0.9853265/469 [===============>..............] - ETA: 16s - loss: 0.0487 - accuracy: 0.9852281/469 [================>.............] - ETA: 14s - loss: 0.0489 - accuracy: 0.9851293/469 [=================>............] - ETA: 13s - loss: 0.0484 - accuracy: 0.98532021-07-21 07:34:52,514 : swarm.mlCnt : INFO : Merging ...
301/469 [==================>...........] - ETA: 18s - loss: 0.0485 - accuracy: 0.9853317/469 [===================>..........] - ETA: 15s - loss: 0.0484 - accuracy: 0.9855329/469 [====================>.........] - ETA: 13s - loss: 0.0484 - accuracy: 0.9854345/469 [=====================>........] - ETA: 11s - loss: 0.0480 - accuracy: 0.9856360/469 [======================>.......] - ETA: 9s - loss: 0.0480 - accuracy: 0.9856 372/469 [======================>.......] - ETA: 8s - loss: 0.0481 - accuracy: 0.9854385/469 [=======================>......] - ETA: 7s - loss: 0.0481 - accuracy: 0.9855400/469 [========================>.....] - ETA: 5s - loss: 0.0476 - accuracy: 0.9856414/469 [=========================>....] - ETA: 4s - loss: 0.0478 - accuracy: 0.98572021-07-21 07:35:03,364 : swarm.mlCnt : INFO : Merging ...
429/469 [==========================>...] - ETA: 4s - loss: 0.0478 - accuracy: 0.9857451/469 [===========================>..] - ETA: 1s - loss: 0.0472 - accuracy: 0.9859469/469 [==============================] - 43s 92ms/step - loss: 0.0473 - accuracy: 0.9859
2021-07-21 07:35:13,722 : swarm.mlCnt : INFO : Finished local training rounds
2021-07-21 07:35:13,722 : swarm.mlCnt : INFO : Continuing syncs till minimum required peers finish ...
2021-07-21 07:35:13,723 : swarm.mlCnt : INFO : Checkin model: Snapshot, Using Final local version
2021-07-21 07:35:25,105 : swarm.mlCnt : INFO : All peers finished. Loading final model
2021-07-21 07:35:25.237271: W tensorflow/python/util/util.cc:329] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow/python/ops/resource_variable_ops.py:1817: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Saved the trained model!
